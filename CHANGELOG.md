# 更新日志

本文档记录私人导航网站项目的所有版本更新历史。

## [1.1.2] - 2025-08-15

### 修复
- **修复链接访问问题**
  - 修复了点击链接时会带上 localhost 前缀的问题
  - 自动为没有协议前缀的 URL 添加 http://
  - 支持用户直接输入域名（如 google.com）而无需手动添加 http://
  - 影响页面：分类管理页面、用户主页、首页

## [1.1.1] - 2025-08-15

### 安全修复
- **修复忘记密码功能的重大安全漏洞**
  - 修复了验证安全问题时随便填写内容也能通过的问题
  - 新增 `/api/auth/verify-security-answer` 接口，专门用于验证安全问题答案
  - 实现基于令牌的密码重置机制，使用加密令牌替代直接传递安全答案
  - 重置令牌有效期为10分钟，过期自动失效
  - 防止恶意用户绕过安全验证直接重置密码
  - 增强前端验证流程，确保每一步都经过后端验证
  - 将令牌有效期调整为60秒，增强安全性

### 新增功能
- **密码重置倒计时功能**
  - 实时显示令牌剩余有效时间（60秒）
  - 每秒调用后端接口获取准确的剩余时间
  - 动态进度条展示倒计时进度
  - 剩余10秒时进入紧急状态提醒
  - 令牌过期自动显示超时提示
  - 支持重新验证功能

### 技术改进
- 使用 crypto 模块生成安全的随机令牌
- 实现令牌过期自动清理机制
- 前端清除敏感数据，避免信息泄露
- 前端使用独立的 axios 实例避免全局拦截器干扰
- 新增 `/api/auth/token-remaining-time` 接口查询令牌状态

## [1.1.0] - 2025-08-15

### 新增功能
- **忘记密码功能**
  - 用户注册时可设置安全问题和答案
  - 支持通过安全问题验证身份后重置密码
  - 三步式密码重置流程（输入邮箱 → 回答问题 → 设置新密码）
  - 答案验证不区分大小写，自动去除首尾空格

### 数据库变更
- `users` 表新增 `security_question` 字段
- `users` 表新增 `security_answer` 字段（加密存储）
- 提供数据库迁移脚本 `backend/src/migrations/add-security-fields.ts`

### 技术改进
- 创建安全的数据库迁移机制，保护现有数据
- 优化用户体验，提供清晰的错误提示
- 响应式设计，支持移动端访问

### 升级指南
1. 停止后端服务
2. 执行数据库迁移：
   ```bash
   cd backend
   npx ts-node src/migrations/add-security-fields.ts
   ```
3. 重新启动服务

## [1.0.1] - 2025-08-14

### 新增功能
- **链接拖拽排序**
  - 支持在分类内拖拽调整链接顺序
  - 自动保存排序结果到后端
  - 流畅的动画效果

- **链接默认图标**
  - 创建链接时自动分配随机emoji图标
  - 支持URL图标、Emoji图标和占位符三种显示方式

### 依赖更新
- 添加 `vuedraggable@4.1.0` 支持拖拽功能

## [1.0.0] - 2025-08-13

### 初始版本发布

#### 核心功能
- **用户系统**
  - 用户注册（用户名、邮箱、密码）
  - 用户登录（JWT认证）
  - 会话管理

- **分类管理**
  - 创建、编辑、删除分类
  - 分类排序
  - 分类图标和颜色自定义

- **链接管理**
  - 添加、编辑、删除链接
  - 链接归属分类
  - 链接标题、URL、描述管理
  - 批量操作支持

#### 技术栈
- **前端**: Vue 3 + TypeScript + Vite + Element Plus + Pinia
- **后端**: Node.js + Express + TypeScript + Sequelize
- **数据库**: SQLite
- **认证**: JWT

#### 项目结构
```
├── backend/          # 后端服务
│   ├── src/
│   │   ├── models/      # 数据模型
│   │   ├── controllers/ # 控制器
│   │   ├── routes/      # 路由
│   │   ├── middleware/  # 中间件
│   │   └── utils/       # 工具函数
│   └── database.sqlite  # 数据库文件
│
├── frontend/         # 前端应用
│   ├── src/
│   │   ├── pages/       # 页面组件
│   │   ├── stores/      # 状态管理
│   │   ├── router/      # 路由配置
│   │   └── utils/       # 工具函数
│   └── index.html
│
└── documents/        # 项目文档
    ├── 设计文档.MD
    └── 开发日志.md
```

---

## 版本号说明

本项目遵循语义化版本规范（Semantic Versioning）：

- **主版本号（MAJOR）**：不兼容的 API 修改
- **次版本号（MINOR）**：向下兼容的功能性新增
- **修订号（PATCH）**：向下兼容的问题修正

格式：`MAJOR.MINOR.PATCH`

### 版本标签
- `[新增]` - 新功能
- `[修复]` - Bug 修复
- `[变更]` - 功能变更
- `[优化]` - 性能优化
- `[文档]` - 文档更新
- `[依赖]` - 依赖更新
- `[破坏性]` - 破坏性变更，需要注意兼容性

---
